deploy:
  stage: deploy
  script:
    - >
      # Clone GitHub repository
      git clone https://github.com/ishaqbuic/test_repo.git
      cd test_repo
      pwd
      ls
      echo "Cloning repository"
      # Configure Git user
      git config --local user.email "ishaqbuic@gmail.com" # Fix the typo here
      git config --local user.name "ishaqbuic" # Use your GitHub username here

      echo "Github configuration done"

      # Add GitHub repository as remote
      git remote add github https://github.com/ishaqbuic/test_repo.git # Uncomment this line
      echo "Github remote add done"
      
      # Checkout main branch
      git checkout main
      echo "checkout main done"

      #Pull latest changes from origin and GitHub
      git pull origin main
      git pull github main # Make sure the branch name is correct here
      echo "pull done"

      # Display current status
      git status

      # Commit and push changes to GitHub
      git add .
      git commit -m "Auto push from GitLab CI/CD pipeline - main"
      git push github main # Simplify the push command
      echo "push done"
  only:
    - main
